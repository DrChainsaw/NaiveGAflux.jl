<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Crossover Operations · NaiveGAflux</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NaiveGAflux</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../examples/quicktutorial/">Quick Tutorial</a></li><li><span class="tocitem">AutoFlux</span><ul><li><a class="tocitem" href="../../autoflux/">AutoFlux</a></li><li><a class="tocitem" href="../../autoflux/reference/reference/">AutoFlux API Reference</a></li></ul></li><li><span class="tocitem">Components</span><ul><li><a class="tocitem" href="../../examples/searchspace/">Search Spaces</a></li><li><a class="tocitem" href="../../examples/mutation/">Mutation Operations</a></li><li><a class="tocitem" href="../../examples/crossover/">Crossover Operations</a></li><li><a class="tocitem" href="../../examples/fitness/">Fitness Functions</a></li><li><a class="tocitem" href="../../examples/candidate/">Candidate Utilities</a></li><li><a class="tocitem" href="../../examples/evolution/">Evolution Strategies</a></li><li><a class="tocitem" href="../../examples/iterators/">Iterators</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../searchspace/">Search Spaces</a></li><li><a class="tocitem" href="../mutation/">Mutation Operations</a></li><li class="is-active"><a class="tocitem" href>Crossover Operations</a><ul class="internal"><li><a class="tocitem" href="#Core-Vertex-Crossover-Operations"><span>Core Vertex Crossover Operations</span></a></li><li><a class="tocitem" href="#Core-Optimizer-Crossover-Operations"><span>Core Optimizer Crossover Operations</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li></ul></li><li><a class="tocitem" href="../fitness/">Fitness Functions</a></li><li><a class="tocitem" href="../candidate/">Candidate Utilities</a></li><li><a class="tocitem" href="../evolution/">Evolution Strategies</a></li><li><a class="tocitem" href="../batchsize/">Batch Size Utilities</a></li><li><a class="tocitem" href="../iterators/">Iterators</a></li><li><a class="tocitem" href="../utils/">Misc. Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Crossover Operations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Crossover Operations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DrChainsaw/NaiveGAflux.jl/blob/master/docs/src/reference/crossover.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="CrossoverOperationsAPI"><a class="docs-heading-anchor" href="#CrossoverOperationsAPI">Crossover Operations</a><a id="CrossoverOperationsAPI-1"></a><a class="docs-heading-anchor-permalink" href="#CrossoverOperationsAPI" title="Permalink"></a></h1><div class="admonition is-success"><header class="admonition-header">Tip!</header><div class="admonition-body"><p>Most <a href="../mutation/#Wrapping-Mutation-Operations">Wrapping Mutation Operations</a> work for crossover too!</p></div></div><h2 id="Core-Vertex-Crossover-Operations"><a class="docs-heading-anchor" href="#Core-Vertex-Crossover-Operations">Core Vertex Crossover Operations</a><a id="Core-Vertex-Crossover-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Vertex-Crossover-Operations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NaiveGAflux.VertexCrossover" href="#NaiveGAflux.VertexCrossover"><code>NaiveGAflux.VertexCrossover</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">VertexCrossover{S, PF, CF}
VertexCrossover(crossover ;selection=FilterMutationAllowed(), pairgen=default_pairgen)
VertexCrossover(crossover, deviation::Number; selection=FilterMutationAllowed())</code></pre><p>Applies <code>crossover</code> to each pair of selected vertices from two <code>CompGraph</code>s.</p><p>Vertices to select from the first graph is determined by <code>selection</code> (default <code>FilterMutationAllowed</code>) while <code>pairgen</code>  (default <a href="#NaiveGAflux.default_pairgen"><code>default_pairgen</code></a>) determines how to pair the selected vertices with vertices in the second graph.</p><p>The default pairing function will try to pair vertices which have similar relative topologial order within their graphs.  For instance, if the first graph has 5 vertices and the second has 10, it will pair vertex 2 from the first graph with vertex 4 from the second (assuming they are of compatible type). The parameter <code>deviation</code> can be used to inject noise in this process so that the pairing will randomly deviate where the magnitude of <code>deviation</code> sets how much and how often.</p><p>See also <a href="#NaiveGAflux.crossover"><code>crossover</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DrChainsaw/NaiveGAflux.jl/blob/6649b1f5515d009e530e454c3330181127d65e29/src/crossover.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NaiveGAflux.CrossoverSwap" href="#NaiveGAflux.CrossoverSwap"><code>NaiveGAflux.CrossoverSwap</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CrossoverSwap{F1, F2, F3, S} &lt;: AbstractCrossover{&lt;:AbstractVertex}
CrossoverSwap(pairgen, mergefun, strategy, selection)
CrossoverSwap(;pairgen=default_inputs_pairgen, mergefun=default_mergefun, strategy=default_crossoverswap_strategy, selection=FilterMutationAllowed())
CrossoverSwap(deviation::Number; mergefun=default_mergefun, strategy=default_crossoverswap_strategy, selection=FilterMutationAllowed())</code></pre><p>Swap out a part of one graph with a part of another graph, making sure that the graphs do not become connected in the process.</p><p>More concretely, swaps a set of consecutive vertices <code>vs1</code> set of consecutive vertices <code>vs2</code> returning the swapped <code>v1</code> and <code>v2</code> respectively if successful or <code>v1</code> and <code>v2</code> if not.</p><p>The last vertex in <code>vs1</code> is <code>v1</code> and the last vertex of <code>vs2</code> is <code>v2</code>. The other members of <code>vs1</code> and <code>vs2</code> are determined  by <code>pairgen</code> (default <a href="#NaiveGAflux.default_inputs_pairgen"><code>default_inputs_pairgen</code></a>) and <code>selection</code> (default <code>FilterMutationAllowed</code>).</p><p>If a vertex <code>v</code> is not capable of having multiple inputs (determined by <code>singleinput(v) == true</code>), <code>vm = mergefun(vi)</code> where  <code>vi</code> is the input to <code>v</code> will be used instead of <code>v</code> and <code>v</code> will be added as the output of <code>vm</code> if necessary.</p><p>See also <a href="#NaiveGAflux.crossoverswap"><code>crossoverswap</code></a>.</p><p>Note: High likelyhood of large accuracy degradation after applying this mutation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DrChainsaw/NaiveGAflux.jl/blob/6649b1f5515d009e530e454c3330181127d65e29/src/crossover.jl#L29-L49">source</a></section></article><h2 id="Core-Optimizer-Crossover-Operations"><a class="docs-heading-anchor" href="#Core-Optimizer-Crossover-Operations">Core Optimizer Crossover Operations</a><a id="Core-Optimizer-Crossover-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Optimizer-Crossover-Operations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NaiveGAflux.OptimizerCrossover" href="#NaiveGAflux.OptimizerCrossover"><code>NaiveGAflux.OptimizerCrossover</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OptimizerCrossover{C} &lt;: AbstractCrossover{FluxOptimizer}
OptimizerCrossover()
OptimizerCrossover(crossover)</code></pre><p>Apply crossover between optimizers.</p><p>Type of crossover is determined by <code>crossover</code> (default <code>optimizerswap</code>) which when given a a tuple of two optimizers will return the result of the crossover operation as a tuple of optimizers.</p><p>Designed to be composable with most utility <code>AbstractMutation</code>s as well as with itself. For instance, the following seemingly odd construct will swap components of a <code>Flux.Optimiser</code> with a probability of <code>0.2</code> per component:</p><p><code>OptimizerCrossover(MutationProbability(OptimizerCrossover(), 0.2))</code></p><p>Compare with the following which either swaps all components or none:</p><p><code>MutationProbability(OptimizerCrossover(), 0.2)</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DrChainsaw/NaiveGAflux.jl/blob/6649b1f5515d009e530e454c3330181127d65e29/src/crossover.jl#L399-L415">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NaiveGAflux.LearningRateCrossover" href="#NaiveGAflux.LearningRateCrossover"><code>NaiveGAflux.LearningRateCrossover</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">LearningRateCrossover()</code></pre><p>Return an <code>OptimizerCrossover</code> which will swap learning rates between optimizers but not change anything else.</p><p>Does not do anything if any of the optimizers don&#39;t have a learning rate (e.g. WeightDecay).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DrChainsaw/NaiveGAflux.jl/blob/6649b1f5515d009e530e454c3330181127d65e29/src/crossover.jl#L421-L427">source</a></section></article><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NaiveGAflux.crossover" href="#NaiveGAflux.crossover"><code>NaiveGAflux.crossover</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">crossover(g1::CompGraph, g2::CompGraph; selection=FilterMutationAllowed(), pairgen=default_pairgen, crossoverfun=crossoverswap)</code></pre><p>Perform crossover between <code>g1</code> and <code>g2</code> and return the two children <code>g1&#39;</code> and <code>g2&#39;</code>.</p><p>How the crossover is performed depends on <code>pairgen</code> and <code>crossoverfun</code> as well as <code>selection</code>.</p><p><code>selection</code> is used to filter out at which vertices the crossoverpoints may be.</p><p><code>pairgen</code> return indices of the potential crossover points to use out of the allowed crossover points. New crossover points will be drawn from pairgen until it returns <code>nothing</code>.</p><p><code>crossoverfun</code> return the result of the crossover which may be same as inputs depending on implementation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DrChainsaw/NaiveGAflux.jl/blob/6649b1f5515d009e530e454c3330181127d65e29/src/crossover.jl#L62-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NaiveGAflux.crossoverswap" href="#NaiveGAflux.crossoverswap"><code>NaiveGAflux.crossoverswap</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">crossoverswap((v1,v2)::Tuple; pairgen=default_inputs_pairgen, selection=FilterMutationAllowed(), kwargs...)</code></pre><p>Perform <a href="#NaiveGAflux.crossoverswap!"><code>crossoverswap!</code></a> with <code>v1</code> and <code>v2</code> as output crossover points.</p><p>Inputs are selected from the feasible set (as determined by <code>separablefrom</code> and <code>selection</code>) through the supplied <code>pairgen</code> function.</p><p>Inputs <code>v1</code> and <code>v2</code> along with their entire graph are copied before operation is performed and originals are returned if operation is not successful.</p><p>Additional keyword arguments will be passed on to <a href="#NaiveGAflux.crossoverswap!"><code>crossoverswap!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DrChainsaw/NaiveGAflux.jl/blob/6649b1f5515d009e530e454c3330181127d65e29/src/crossover.jl#L176-L186">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NaiveGAflux.crossoverswap!" href="#NaiveGAflux.crossoverswap!"><code>NaiveGAflux.crossoverswap!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">crossoverswap!(v1::AbstractVertex, v2::AbstractVertex) = crossoverswap!(v1,v1,v2,v2)
crossoverswap!(vin1::AbstractVertex, vout1::AbstractVertex, vin2::AbstractVertex, vout2::AbstractVertex)</code></pre><p>Swap vertices <code>vin1</code> to <code>vout1</code> with <code>vin2</code> and <code>vout2</code> so that <code>vin1</code> to <code>vin2</code> is placed in the same position of the graph as <code>vin2</code> to <code>vout2</code> and vice versa.</p><p>Vertices must come from different graphs.</p><p>This operation can fail, leaving one or both graphs in a corrupted state where evaluating them results in an error (typically a <code>DimensionMismatch</code> error).</p><p>Return a tuple <code>(success1, success2)</code> where <code>success1</code> is true if <code>vin2</code> and <code>vout2</code> was successfully swapped in to the graph which previously contained <code>vin1</code> and <code>vout1</code> and vice versa for <code>success2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DrChainsaw/NaiveGAflux.jl/blob/6649b1f5515d009e530e454c3330181127d65e29/src/crossover.jl#L221-L232">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NaiveGAflux.default_pairgen" href="#NaiveGAflux.default_pairgen"><code>NaiveGAflux.default_pairgen</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">default_pairgen(vs1, vs2, deviation = 0.0; rng=rng_default, compatiblefun = sameactdims, ind1 = rand(rng, eachindex(vs1)))</code></pre><p>Return integers <code>ind1</code> and <code>ind2</code> so that <code>vs1[ind1]</code> and <code>vs2[ind2]</code> are a suitable pair for crossover.</p><p>Input function <code>compatiblefun(v1,v2)</code> shall return <code>true</code> if <code>v1</code> and <code>v2</code> can be swapped and is used to determine the set of vertices to select from given.</p><p>From the set of compatible vertices in <code>vs2</code>, the one which has the smallest relative topologial distance from <code>vs1[ind2]</code> is selected. The parameter <code>devation</code> can be used to randomly deviate from this where larger magnitude means more deviation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DrChainsaw/NaiveGAflux.jl/blob/6649b1f5515d009e530e454c3330181127d65e29/src/crossover.jl#L115-L123">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NaiveGAflux.default_inputs_pairgen" href="#NaiveGAflux.default_inputs_pairgen"><code>NaiveGAflux.default_inputs_pairgen</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">default_inputs_pairgen(vs1, vs2, args...;kwargs...)</code></pre><p>Same as <a href="#NaiveGAflux.default_pairgen"><code>default_pairgen</code></a> except it also ensures that shape changes of feature maps are consistent between the pairs.</p><p>Feature map here refers to the shape of inputs to convolutional-type layers (Conv, Pooling) in dimensions other than the batch dimension or the channel dimension.</p><p>For example, for 2D convolutions, the arrays may have the shape WxHxCxB where C and B are the channel and batch dimensions respectively. The shape of the feature map in this case is then WxH.</p><p>More concretely, if <code>x</code> is the shape of a feature maps input to <code>vin1</code> and <code>f1(x)</code> is the shape of the feature maps output from <code>vout1</code> and <code>f2</code> describes the same relation between <code>vin2</code> and <code>vout2</code> then only vertices <code>vin2&#39;</code> for which <code>f1(x) == f2(x) ∀ x</code> for a selected vertex <code>vin1</code> may be returned.</p><p>This function assumes that the last vertex in <code>vs1</code> and <code>vs2</code> are <code>vout1</code> and <code>vout2</code> respectively.</p><p>This prevents issues where graphs become inconsistent due to</p><ol><li>Feature maps become zero sized</li><li>Feature maps of different sizes are merged (e.g. concatenated or element wise added)</li></ol><p>Note that this is more strict than needed as a change in the feature maps size does not necessarily result in 1) or 2).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DrChainsaw/NaiveGAflux.jl/blob/6649b1f5515d009e530e454c3330181127d65e29/src/crossover.jl#L139-L157">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mutation/">« Mutation Operations</a><a class="docs-footer-nextpage" href="../fitness/">Fitness Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.18 on <span class="colophon-date" title="Saturday 4 June 2022 12:03">Saturday 4 June 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
